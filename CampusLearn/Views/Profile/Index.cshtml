@model CampusLearn.Models.Student
@{
    ViewData["Title"] = "Profile";
}
<style>
    :root {
        --campus-purple: #6C3EFF;
        --campus-purple-dark: #4B2BD1;
        --campus-purple-light: #f5f2ff;
        --text-dark: #1e1e2f;
        --text-muted: #666;
    }

    /* 🔹 Header Gradient Bar */
    .profile-header {
        width: 100%;
        height: 180px;
        background: linear-gradient(270deg, var(--campus-purple), #9b72ff, var(--campus-purple-dark));
        background-size: 600% 600%;
        animation: gradientMove 10s ease infinite;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        border-radius: 0 0 25px 25px;
        box-shadow: 0 4px 18px rgba(108, 62, 255, 0.3);
    }

    @@keyframes gradientMove {
        0%

    {
        background-position: 0% 50%;
    }

    50% {
        background-position: 100% 50%;
    }

    100% {
        background-position: 0% 50%;
    }

    }

    .profile-header h1 {
        font-size: 2.2rem;
        font-weight: 700;
        letter-spacing: 0.5px;
        text-shadow: 0 3px 8px rgba(0, 0, 0, 0.25);
    }

    /* 🔹 Main Container */
    .profile-container {
        background: #fff;
        border-radius: 20px;
        padding: 40px;
        margin: -60px auto 50px;
        max-width: 950px;
        box-shadow: 0 6px 25px rgba(108, 62, 255, 0.12);
        display: flex;
        flex-wrap: wrap;
        gap: 40px;
        position: relative;
        z-index: 2;
    }

    /* Sidebar */
    .profile-sidebar {
        flex: 1 1 260px;
        text-align: center;
        border-right: 1px solid #f0f0f0;
        padding-right: 30px;
    }

    .profile-avatar img {
        width: 150px;
        height: 150px;
        border-radius: 50%;
        object-fit: cover;
        border: 4px solid var(--campus-purple);
        box-shadow: 0 4px 12px rgba(108, 62, 255, 0.25);
    }

    .profile-basic h3 {
        margin-top: 18px;
        font-size: 1.9rem;
        font-weight: 600;
        color: var(--text-dark);
    }

    .badge {
        display: inline-block;
        margin-top: 6px;
        font-size: 0.9rem;
        padding: 6px 14px;
        border-radius: 14px;
        background-color: var(--campus-purple);
        color: white;
        font-weight: 500;
        box-shadow: 0 2px 6px rgba(108, 62, 255, 0.25);
    }

    /* Details */
    .profile-details {
        flex: 2 1 600px;
    }

        .profile-details table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0 12px;
        }

        .profile-details th {
            color: var(--text-muted);
            font-weight: 600;
            font-size: 1rem;
            width: 160px;
        }

        .profile-details td {
            font-size: 1.05rem;
            font-weight: 500;
            color: var(--text-dark);
        }

    .form-control {
        border-radius: 10px;
        border: 1px solid #d5ccff;
        padding: 8px 12px;
        width: 100%;
        font-size: 1rem;
        transition: 0.2s ease;
    }

    .editable[readonly] {
        background-color: transparent;
        border: none;
        color: var(--text-dark);
        padding: 0;
    }

    .editable:not([readonly]):focus {
        border-color: var(--campus-purple);
        box-shadow: 0 0 0 2px rgba(108, 62, 255, 0.25);
    }

    /* Buttons */
    .btn {
        border-radius: 10px;
        font-weight: 600;
        font-size: 0.95rem;
        padding: 8px 18px;
        transition: all 0.25s ease;
    }

    .btn-primary {
        background-color: var(--campus-purple);
        border: none;
        color: #fff;
    }

        .btn-primary:hover {
            background-color: var(--campus-purple-dark);
            transform: translateY(-1px);
        }

    .btn-success {
        background-color: #6fd37a;
        color: #fff;
        border: none;
    }

    .btn-secondary {
        background-color: #e2dcff;
        color: var(--campus-purple-dark);
        border: none;
    }

    /* Footer Shortcuts */
    .footer-shortcuts {
        display: flex;
        justify-content: center;
        gap: 50px;
        margin-top: 40px;
        padding-top: 25px;
        border-top: 1px solid #eee;
    }

        .footer-shortcuts a {
            text-align: center;
            text-decoration: none;
            color: var(--text-dark);
            transition: color 0.2s ease;
        }

        .footer-shortcuts img {
            height: 30px;
            opacity: 0.85;
            margin-bottom: 6px;
        }

        .footer-shortcuts a:hover {
            color: var(--campus-purple);
        }

    /* Alert */
    .alert {
        background-color: #f2edff;
        border: 1px solid #d8c9ff;
        color: var(--campus-purple-dark);
        padding: 12px 18px;
        border-radius: 10px;
        margin-bottom: 15px;
        font-size: 0.95rem;
        box-shadow: 0 2px 6px rgba(108, 62, 255, 0.1);
    }

    /* Logout */
    .btn-outline-danger {
        border-color: #ff4b6e;
        color: #ff4b6e;
    }

        .btn-outline-danger:hover {
            background-color: #ff4b6e;
            color: #fff;
        }
</style>

<!-- 🔮 Animated Gradient Header -->
<div class="profile-header">
    <h1>My Profile</h1>
</div>

<!-- 🔹 Main Profile Card -->
<div class="profile-container">
    <!-- Left -->
    <div class="profile-sidebar">
        <div class="profile-avatar">
            <img src="~/images/10619319.png" alt="Profile Picture" />
        </div>
        <div class="profile-basic">
            <h3>@Model.FirstName @Model.LastName</h3>
            <span class="badge">STUDENT</span>
        </div>
    </div>

    <!-- Right -->
    <div class="profile-details">
        @if (TempData["Success"] != null)
        {
            <div class="alert">@TempData["Success"]</div>
        }

        <form asp-action="UpdateProfile" asp-controller="Profile" method="post" id="profileForm">
            <input type="hidden" name="StudentID" value="@Model.StudentID" />

            <table>
                <tbody>
                    <tr>
                        <th>Student ID</th>
                        <td>@Model.StudentID</td>
                    </tr>
                    <tr>
                        <th>Email</th>
                        <td>
                            <input type="email" name="PersonalEmail" class="form-control editable"
                                   value="@Model.PersonalEmail" readonly required />
                        </td>
                    </tr>
                    <tr>
                        <th>Phone</th>
                        <td>
                            <input type="text" name="Phone" class="form-control editable"
                                   value="@Model.Phone" readonly required />
                        </td>
                    </tr>
                    <tr>
                        <th>Groups</th>
                        <td>
                            @foreach (var group in Model.Groups)
                            {
                                <span class="badge bg-info me-1">@group</span>
                            }
                        </td>
                    </tr>
                </tbody>
            </table>

            <div class="mt-4 d-flex gap-2">
                <button type="button" id="editBtn" class="btn btn-primary">Edit</button>
                <button type="submit" id="saveBtn" class="btn btn-success d-none">Save</button>
                <button type="button" id="cancelBtn" class="btn btn-secondary d-none">Cancel</button>
            </div>
        </form>
    </div>
</div>

<!-- Footer -->
<div class="footer-shortcuts">
    <a href="#">
        <img src="~/images/seal.svg" alt="Badges" />
        <div>Badges</div>
    </a>
    <a asp-controller="Messages" asp-action="Index">
        <img src="~/images/chat.svg" alt="Messages" />
        <div>Messages</div>
    </a>
</div>

<!-- Logout -->
<div class="text-center mt-4 mb-5">
    <form method="post" asp-action="Logout" asp-controller="Profile" class="d-inline-block">
        @Html.AntiForgeryToken()
        <button type="submit" class="btn btn-outline-danger d-flex align-items-center gap-2">
            <img src="~/images/sign-out.svg" alt="Log Out Icon" style="height: 20px;" />
            Log Out
        </button>
    </form>
</div>

@section Scripts {
    <script>
        const editBtn = document.getElementById('editBtn');
        const saveBtn = document.getElementById('saveBtn');
        const cancelBtn = document.getElementById('cancelBtn');
        const editableFields = document.querySelectorAll('.editable');

        editBtn.addEventListener('click', () => {
            editableFields.forEach(f => f.removeAttribute('readonly'));
            editBtn.classList.add('d-none');
            saveBtn.classList.remove('d-none');
            cancelBtn.classList.remove('d-none');
        });

        cancelBtn.addEventListener('click', () => {
            window.location.reload();
        });
    </script>
}
